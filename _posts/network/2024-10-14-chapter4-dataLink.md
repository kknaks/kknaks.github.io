---
title:  4장 데이터링크 계층, MAC 주소로 통신하는 단계
date: 2024-10-14 1:35:23 +0900
category: [network]
tags: network, sc기초
permalink: /blog/network04/
---

# 데이터링크 계층
**데이터링크계층의 역할**
- 데이터를 관리하고 전달하는 계층으로, 데이터 전송의 신뢰성과 효율성에 중요한 역할을 한다.
- 데이터를 작은 프레임 단위로 분할하고, MAC주소를 활용하여 장비를 식별한다. 
- 데이터가 동시에 전달 될 경우, 충돌을 및 오류를 탐지하고 충돌관리 및 수정하는 역할을 한다.
- 오류를 감지하거나 수정하는 방식으로는 회선제어, 오류제어, 흐름제어가 있다. 

## 1. 회선제어
**정의**
- 오류를 감지하기보다는 **회피하는 방법**으로 신호간 충돌현상이 발생하지 않도록 제어한다. 
- 신호의 시작 ENQ(Enquiry)와 끝 EOT(End of Transmission)을 지정하여 신호간 충돌을 피한다.
  ![image](https://github.com/user-attachments/assets/caa33da3-ea59-46b8-a777-0435748d162e)

## 2. 오류제어
**정의**
- 송수신데이터가 **외부 간섭, 시간지연**등에 의해 데이터가 변형되거나 
순서가 어긋나는 등의 통신 장애가 발생하지 않도록 오류를 검출하고 정정하여 통신에 대한 신뢰성을 확보하는 방법이다.

**종류**
- **패러티검사** : 수신자에게 보내는 최종 데이터의 1의 개수를 짝수(even parity)개 혹은 홀수(odd parity)개로 보낼지 송,수신자가 미리 약속을 하고 여분의 비트(패리티비트)를 채워 보내는 방법
- **CRC검사** : 데이터에 CRC코드를 추가하여 오류를 감지하는 방법으로, 송신자가 CRC코드를 생성하고 수신자 측에서도 동일한 계산을 수행하여 일치 여부를 확인하는 방법
- **검사합** : 데이터의 각 바이트값을 더하거나 연산하여 생성되는 값을 송신자와 수신자가 비교하여 동일한지 검사하는 방법

## 3. 흐름제어 
**정의**
- 송신자와 수신자의 데이터 처리속도 차이를 해결하기 위해 수신자 상황에 따라 송신자의 데이터 전송량을 조정하는 방법
- 수신자가 ACK(데이터를 받았다는 메세지)를 보내야 송신자가 다음 데이터를 보낸다.

# 이더넷
**이더넷이란**
- 다수의 컴퓨터, 허브, 스위치 등을 하나의 인터넷 케이블에 연결한 네트워크 구조 
-  CSMA/CD(Carrier Sense Multiple Access/Collision Detection) 프로토콜을 사용

## 1. CSMA/CD
- 데이터 송신시 충돌을 방지하기 위해 전류의 강도를 확인해 케이블의 사용 유무를 확인하고 데이터를 전송하는 프로토콜

  ![image](https://github.com/user-attachments/assets/f1436b7e-682f-4ff9-b0b3-231e7b29228c)

# MAC주소
**MAC이란**
- Media Access Control 주소로 랜카드에 할당된 값이며, 48비트로 이루어진 고유한 값이다. 
- OUI(Organizational Unique Identifier) : 상위 24비트에 할당되며 랜카드 제조사에 부여된 코드이다.
- UAA(Universally Administrered Address) : 제조사가 랜카드에 부여한 고유번호이다.
 ![image](https://github.com/user-attachments/assets/35beb19a-4551-498b-9f76-a092ec2dc43f)

  ```
  8bit 단위로 하이픈(-)이나 콜론을(:) 사용해 16진술로 표기한다.
  1C-1B-B5-08-A4-26
  1C:1B:B5:08:A4:26
  ```

## 1. MAC주소의 활용
### 1) 프레임의 구조
- OSI7의 2계층에서는 MAC주소를 헤더에 넣어 프레임을 생성한다. 
- 송신자의 MAC주소와 수신자의 MAC주소를 포함하여 헤더를 생성한다. 
- 이더넷 헤더에는 이 MAC주소값과 프로토콜 정보를 추가하여 송신한다. 

  ![image](https://github.com/user-attachments/assets/5f054ef4-e652-4df7-bae3-9dd3cc2b15d8)

### 2) 프로토콜의 종류
- 프로토콜에는 IPv4, ARP, IPv6가 있다. 
- IPv4 : 현재 사용되고 있는 일반적인 32비트의 IP 주소
- IPv6 : IPv4주소 부족문제를 해결하기 위한 128비트의 IP주소
- ARP : IP주소와 MAC주소를 매핑해주는 프로토콜

### 3) ARP를 이용하여 MAC주소를 얻는 과정
- ARP(Address Resolution Protocl)은 IP주소와 MAC주소를 매핑하여 MAC주소를 알아낸다. 
- PC -> 허브 -> 라우터 -> 허브 -> PC 순으로 진행된다. 
  
  ```
  컴퓨터 A(IP주소 192.168.0.2)가 컴퓨터 B(IP주소 192.168.0.3)에게 데이터를 전송하려한다.
  ```
  1. 컴퓨터 A는 같은 허브에 묶여 있는 모든 컴퓨터에게 192.168.0.3이라는 IP주소의 MAC주소를 묻는다. <br>
      (모든 컴퓨터에게 질의 하는 행위를 브로드캐스트라고 하며, MAC주소를 묻는 것을 ARP요청이라고 한다.) 
  2. 허브에 묶여 있는 컴퓨터는 자신의 IP와 192.168.0.3과 비교를 하고, 최종적으로 컴퓨터B가 자신의 MAC주소를 전달한다. <br>
     (이것을 ARP응답이라고 한다.)
  3. ARP응답을 받은 컴퓨터 A는 B의 IP와 MAC주소를 테이블로 정리하여 저장한다.<br>
     (이 테이블을 ARP테이블 이라고 한다.)
  4. 이러한 과정을 통해 컴퓨터 A는 컴퓨터 B와 통신을 할 수 있게 된다. 

  ![image](https://github.com/user-attachments/assets/9670748e-3d30-406f-b882-2e3d122ae203)

# 스위치의 구조 
## 1. 스위치의 구조 
- 스위치는 허브와 동일한 기능을 수행하지만, 모든 송수신 데이터를 모든 컴퓨터에 전송하는 허브와 달리 특정 컴퓨터와만 송수신을 하는 구조이다.
- 소규모 네트워크 안에서 컴퓨터, 프린터 등 모든 장칠르 서로 연결해서 데이터를 쉽게 공유할 수 있는 장비 

  ![image](https://github.com/user-attachments/assets/7ce2e658-54a3-42f1-ad62-b73d676c4592)

## 2. 스위치에서 MAC테이블 관리 하기 
- 스위치는 연결된 컴퓨터들 및 다른 장비들의 MAC주소를 관리한다.
  ![image](https://github.com/user-attachments/assets/0ba373db-7be2-46ca-9c9f-09f0e15869a6)

### 1) 플러딩
- **플러딩** : 스위치에 물려있는 모든 컴퓨터에 데이터를 보내는 것을 말한다.
- 플러딩이후에 MAC테이블은 자신의 MAC테이블을 업데이트한다. 

### 2) 필터링
- **필터링** : 스위치를 통해 전달 받은 주소를 통해 송수신 컴퓨터끼리만 통신을 하는 것을 말한다.

# 전송 방향에 따른 통신 방식
- 단방향통신(Simplex Transmission) : 선로가 하나만 있어 일방향 통신만 가능한 통신을 말한다. 
- 채널(Channel) : 컴퓨터가 통신을 하는 선로를 말한다. 
- 양방향 통신(Duplex Transmission) : 하나의 통신 채널에서 송수신이 모두 가능한 방식을 말한다. 

## 1. 양방향 통신의 종류
- **반이중통신(Half Duplex)** : 양방향에서 통신이 가능하지만, 동시에 통신을 할 수 없는 방식
  - 송신과 수신을 번갈아가며 통신을 하기 때문에 **전송속도가 빠르다.**
  - 채널을 하나만 사용하기 때문에 **충돌 문제**가 있다. 
  - 주로 허브에서 사용한다.
  - 충돌이 발생할 때 그 영향이 미치는 범위를 충돌 도메인(Collision Domain)이라고 한다.
  - 반이중통신에서 하나의 허브에 연결된 모든 컴퓨터 들은 충돌 도메인이 된다.
  
![image](https://github.com/user-attachments/assets/37214344-9768-48e3-9b72-10f99d56b23a)

- **전이중통신(Full Duplex)** : 채널을 2개 두어서 양쪽방향에서 동시에 데이터를 주고 받을 수 있는 방식
  - 채널을 2개 사용하기 때문에 **충돌문제에서 자유롭다.**
  - 주로 스위치에서 사용하는 방식이다.

![image](https://github.com/user-attachments/assets/94feae55-b9d1-4ce3-a883-39c0c41e3b29)




